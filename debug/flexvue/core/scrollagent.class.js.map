{"version":3,"file":"scrollagent.class.js","names":["ScrollAgent","constructor","channel","TAG","version","scrollerVertical","scrollerHorizontal","keys","supportsPassive","wheelOpt","wheelEvent","floatEl","floatElScrollPos","addFloatListener","elId","pos","callback","self","document","querySelector","Handler","post","classList","contains","add","addScrollListener","mode","scrollTarget","dataset","scrollch","startVertical","startHorizontal","addEventListener","event","target","_ch","tpos","scrollTop","ScrollObserver","_setPos","remove","passive","createElement","scrollLeft","getPos","_getPos","e","Log","d","getPosById","obj","offsetTop","resetPos","scrollTo","params","delaytime","dtime","scrollToLeft","scrollToBottom","_a","_b","scrollHeight","top","preventDefault","stopImmediatePropagation","preventDefaultForScrollKeys","keyCode","disableScroll","enableScroll","removeEventListener"],"sources":["scrollagent.class.js"],"sourcesContent":["export default class ScrollAgent {\n    constructor(channel) {\n        this.TAG = 'ScrollAgent';\n        this.version = '1.2';\n        this.channel = channel;\n        this.scrollerVertical = null;\n        this.scrollerHorizontal = null;\n        this.keys = { 37: 1, 38: 1, 39: 1, 40: 1 };\n        this.supportsPassive = false;\n        this.wheelOpt = false;\n        this.wheelEvent = 'mousewheel';\n        this.floatEl = null;\n        this.floatElScrollPos = 500;\n    }\n    addFloatListener(elId, pos, callback) {\n        const self = this;\n        this.floatEl = document.querySelector(elId);\n        if (this.floatEl) {\n            self.floatElScrollPos = pos || 500;\n            Handler.post(function () {\n                if (!self.floatEl.classList.contains('hidden')) {\n                    self.floatEl.classList.add('hidden');\n                }\n            }, 1);\n            if (typeof callback === 'function') {\n                callback(this.floatEl);\n            }\n        }\n    }\n    addScrollListener(mode, scrollTarget) {\n        if (mode === 'vertical') {\n            this.scrollerVertical = document.querySelector(scrollTarget);\n            if (this.scrollerVertical) {\n                this.scrollerVertical.dataset.scrollch = this.channel;\n                this.startVertical();\n            }\n        }\n        else if (mode === 'horizontal') {\n            this.scrollerHorizontal = document.querySelector(scrollTarget);\n            if (this.scrollerHorizontal) {\n                this.scrollerHorizontal.dataset.scrollch = this.channel;\n                this.startHorizontal();\n            }\n        }\n    }\n    startVertical() {\n        // 스크롤 캡쳐\n        if (this.scrollerVertical) {\n            this.scrollerVertical.addEventListener(\"scroll\", (event) => {\n                const target = event.target;\n                const _ch = target.dataset.scrollch;\n                let tpos = target.scrollTop;\n                if (_ch !== 'undefined' && _ch === this.channel) {\n                    ScrollObserver._setPos(this.channel, tpos);\n                }\n                // float Layout\n                if (this.floatEl) {\n                    if (tpos < this.floatElScrollPos) {\n                        if (!this.floatEl.classList.contains('hidden')) {\n                            this.floatEl.classList.add('hidden');\n                        }\n                    }\n                    else {\n                        if (this.floatEl.classList.contains('hidden')) {\n                            this.floatEl.classList.remove('hidden');\n                        }\n                    }\n                }\n            });\n            // try {\n            //     window.addEventListener(\"test\", null, Object.defineProperty({}, 'passive', {\n            //         get: () => { this.supportsPassive = true; }\n            //     }));\n            // } catch (e) { }\n            this.wheelOpt = this.supportsPassive ? { passive: false } : false;\n            this.wheelEvent = 'onwheel' in document.createElement('div') ? 'wheel' : 'mousewheel';\n        }\n    }\n    startHorizontal() {\n        const self = this;\n        if (this.scrollerHorizontal) {\n            this.scrollerHorizontal.addEventListener(\"scroll\", (event) => {\n                const target = event.target;\n                const _ch = target.dataset.scrollch;\n                if (_ch === self.channel) {\n                    // Log.d(\"+++++ >\" + _ch + ' ' + tpos);\n                    ScrollObserver._setPos(this.channel, this.scrollerHorizontal.scrollLeft);\n                }\n            });\n        }\n    }\n    getPos() {\n        let pos = 0;\n        try {\n            pos = ScrollObserver._getPos(this.channel);\n        }\n        catch (e) {\n            Log.d(e);\n        }\n        return pos;\n    }\n    getPosById(target) {\n        let pos = 0;\n        const obj = document.querySelector(`#${target}`);\n        if (obj) {\n            pos = obj.offsetTop;\n        }\n        return pos;\n    }\n    resetPos() {\n        ScrollObserver._setPos(this.channel, 0);\n    }\n    scrollTo(params, delaytime) {\n        const self = this;\n        const dtime = delaytime || 0;\n        Handler.post(function () {\n            if (self.scrollerVertical) {\n                self.scrollerVertical.scrollTo(params);\n            }\n        }, dtime);\n    }\n    scrollToLeft(params, delaytime) {\n        const self = this;\n        const dtime = delaytime || 0;\n        Handler.post(function () {\n            if (self.scrollerHorizontal) {\n                self.scrollerHorizontal.scrollTo(params);\n            }\n        }, dtime);\n    }\n    scrollToBottom(delaytime) {\n        const self = this;\n        const dtime = delaytime || 0;\n        if (self.scrollerVertical) {\n            Handler.post(function () {\n                var _a, _b;\n                const pos = (_a = self.scrollerVertical) === null || _a === void 0 ? void 0 : _a.scrollHeight;\n                (_b = self.scrollerVertical) === null || _b === void 0 ? void 0 : _b.scrollTo({ top: pos });\n            }, dtime);\n        }\n    }\n    preventDefault(e) {\n        try {\n            e.stopImmediatePropagation();\n            e.preventDefault();\n        }\n        catch (e) {\n        }\n    }\n    preventDefaultForScrollKeys(e) {\n        if (this.keys[e.keyCode]) {\n            this.preventDefault(e);\n            return false;\n        }\n    }\n    disableScroll() {\n        if (this.scrollerVertical) {\n            this.scrollerVertical.addEventListener('DOMMouseScroll', this.preventDefault, false); // older FF\n            this.scrollerVertical.addEventListener(this.wheelEvent, this.preventDefault, this.wheelOpt); // modern desktop\n            // this.scrollerVertical.addEventListener('touchmove', this.preventDefault, this.wheelOpt); // mobile\n            this.scrollerVertical.addEventListener('touchmove', this.preventDefault, false); // mobile\n            this.scrollerVertical.addEventListener('keydown', this.preventDefaultForScrollKeys, false);\n        }\n    }\n    enableScroll() {\n        if (this.scrollerVertical) {\n            this.scrollerVertical.removeEventListener('DOMMouseScroll', this.preventDefault, false);\n            this.scrollerVertical.removeEventListener(this.wheelEvent, this.preventDefault, this.wheelOpt);\n            // this.scrollerVertical.removeEventListener('touchmove', this.preventDefault, this.wheelOpt);\n            this.scrollerVertical.removeEventListener('touchmove', this.preventDefault);\n            this.scrollerVertical.removeEventListener('keydown', this.preventDefaultForScrollKeys, false);\n        }\n    }\n}\n"],"mappings":"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","ignoreList":[]}